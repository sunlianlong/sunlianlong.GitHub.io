(window.webpackJsonp=window.webpackJsonp||[]).push([[91],{597:function(s,n,e){"use strict";e.r(n);var a=e(3),t=Object(a.a)({},(function(){var s=this,n=s.$createElement,e=s._self._c||n;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("p",[s._v("尝试了三种操作shell,把各种应用环境和方法简单列一下：")]),s._v(" "),e("ol",[e("li",[s._v("pexpect  应用于自动填写账号、密码、交互的回答 本地操作")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("import pexpect\ncmd = 'svn info %s --username %s --password %s' % (project.comeurl, project.comename, project.comepassword)\nrun = pexpect.spawn(cmd)\nresult = 1\ntry:\n   index = run.expect(['Host not found', 'emporarily or accept', \"Last Changed Date\", 'could not connect to server', 'Username:', 'Repository not found:', 'RSA key fingerprint is SHA256', 'please relocate']) # expect可接受字符串和数组\n   print(index)\n   if index == 0:\n       msg = 'svn域名不正确'\n   elif index == 1:\n       run.sendline('t')\n       key = run.expect(['Last Changed Date', \"don't exist\", 'Username:', 'Repository not found:'])\n       if key == 0:\n           result = 0\n           msg = '成功'\n       elif key == 1:\n           msg = 'svn地址不正确'\n       elif key == 2:\n           run.close(force=True)\n           msg = '用户名或密码不正确'\n       else:\n           msg = 'svn地址不正确'\n   elif index == 2:\n       result = 0\n       msg = '成功'\n   elif index == 3:\n       msg = '连接不上svn服务器，请检查内外网域名'\n   elif index == 4:\n       run.close(force=True)\n       msg = '用户名或密码不正确'\n   elif index == 5:\n       msg = 'svn地址不正确'\n   elif index == 6:\n       run.sendline('yes')\n       result = 0\n       msg = '成功'\n   else:\n       msg = 'svn地址不正确'\nexcept Exception as err:\n   print(err)\n   result = 1\n   msg = '未知异常'\nfinally:\n   data = {\"result\": result, \"msg\": msg}\n   return HttpResponse(json.dumps(data))\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br"),e("span",{staticClass:"line-number"},[s._v("21")]),e("br"),e("span",{staticClass:"line-number"},[s._v("22")]),e("br"),e("span",{staticClass:"line-number"},[s._v("23")]),e("br"),e("span",{staticClass:"line-number"},[s._v("24")]),e("br"),e("span",{staticClass:"line-number"},[s._v("25")]),e("br"),e("span",{staticClass:"line-number"},[s._v("26")]),e("br"),e("span",{staticClass:"line-number"},[s._v("27")]),e("br"),e("span",{staticClass:"line-number"},[s._v("28")]),e("br"),e("span",{staticClass:"line-number"},[s._v("29")]),e("br"),e("span",{staticClass:"line-number"},[s._v("30")]),e("br"),e("span",{staticClass:"line-number"},[s._v("31")]),e("br"),e("span",{staticClass:"line-number"},[s._v("32")]),e("br"),e("span",{staticClass:"line-number"},[s._v("33")]),e("br"),e("span",{staticClass:"line-number"},[s._v("34")]),e("br"),e("span",{staticClass:"line-number"},[s._v("35")]),e("br"),e("span",{staticClass:"line-number"},[s._v("36")]),e("br"),e("span",{staticClass:"line-number"},[s._v("37")]),e("br"),e("span",{staticClass:"line-number"},[s._v("38")]),e("br"),e("span",{staticClass:"line-number"},[s._v("39")]),e("br"),e("span",{staticClass:"line-number"},[s._v("40")]),e("br"),e("span",{staticClass:"line-number"},[s._v("41")]),e("br"),e("span",{staticClass:"line-number"},[s._v("42")]),e("br"),e("span",{staticClass:"line-number"},[s._v("43")]),e("br"),e("span",{staticClass:"line-number"},[s._v("44")]),e("br"),e("span",{staticClass:"line-number"},[s._v("45")]),e("br")])]),e("ol",{attrs:{start:"2"}},[e("li",[s._v("subprocess 可查看保留每一步shell的输出，便于返回数据 本地操作")])]),s._v(" "),e("div",{staticClass:"language- line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[s._v("import subprocess\ncmd = 'git clone %s %s/code' % (project.comeurl, path)\nout = subprocess.call(cmd, shell=True) # out为0表示成功 1为失败\ncmd = 'cd %s/code && git log --pretty=oneline' % (path)\nvers=subprocess.getstatusoutput(cmd) # 返回一个数组，第一个值为0表示成功\nprint(vers)\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("ol",{attrs:{start:"3"}},[e("li",[s._v("paramiko 操作远程服务器")])])])}),[],!1,null,null,null);n.default=t.exports}}]);